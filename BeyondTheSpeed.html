<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>프로젝트-BeyondTheSpeed</title>
        <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />
    </head>
    <body id="page-top">
        <!-- Head-->
        <section class="about-section text-center">
            <div class="container px-4 px-lg-5">
                <img class="img-fluid" src="assets/img/BeyondTheSpeed/MainImg.jpg" alt="..." />
            </div>
        </section>
        <!-- Contents-->
        <section class="bg-light">
            <div class="container px-4 px-lg-5">
                <!-- Featured Project Row-->
                <div class="row gx-0 mb-4 mb-lg-5 align-items-center">
                    <div class="bg-black text-center h-100">
                        <h4 class="text-white" style="margin-top: 15px">프로젝트 소개</h4>
                    </div>
                </div>
                <ul class="mb-5">
                    <li>팀 규모: 4명(기획1, 개발3) &#45;&gt; 개발자로 참여(기여도: 25%)</li>
                    <li>프로젝트 성격: 조작감 공부</li>
                    <li>개발 기간: 5일</li>
                    <li>장르: 1인칭 파쿠르</li>
                    <li>게임 설명: 목적지까지 파쿠르를 이용하여 빠르게 도착하는 게임</li>
                    <li>특이 사항: <a href="https://drive.google.com/file/d/1XsXLs5y32TVNbjN4gebajA9hFdV3YV4F/view?usp=sharing">(다운로드)</a></li>
                </ul>
                <div class="row gx-0 mb-4 mb-lg-5 align-items-center">
                    <div class="bg-black text-center h-100">
                        <h4 class="text-white" style="margin-top: 15px">담당 /업무</h4>
                    </div>
                    <h5 class="mt-2">&#8226; 조작</h5>
                    <img class="img-fluid mb-3 mb-lg-0" src="assets/img/BeyondTheSpeed/BreakFall.gif">
                    <details>
                        <summary>낙법 구현 방법</summary>
                        <div class="bg-black text-left h-100 project source-codescroll"><pre class="source-codeplace" style="width: 1200px;"><code class="source-code">
using System.Collections;
using UnityEngine;

public class BreakFallComponent : BaseComponent
{
    private readonly BaseController _controller;
    private BreakFallData _data;

    private PlayerController _playerController;
    private Rigidbody _rigidbody;
    private Camera _camera;

	private bool _isOnBreakFall;

    public BreakFallComponent(BaseController controller, BreakFallData data) : base(controller)
    {
        _controller = controller;
        _data = data;
        _rigidbody = _controller.GetComponent&lt;Rigidbody&gt;();
        _camera = Camera.main;
    }

    public void InitBreakFalling(PlayerController playerController)
    {
		if (_isOnBreakFall) return;

		if (!playerController.playerMovementComponent.IsOnGround)
		{
			Controller.StartCoroutine(CoTryBreakFall(playerController));
		}
    }

    private IEnumerator CoTryBreakFall(PlayerController playerController)
    {
        _isOnBreakFall = true;

        float validTimeCounter = 0;
        float validTime = _data.validTime;
        float yVelocity = 0f;
        while (validTimeCounter &lt; validTime)
        {
            validTimeCounter += Time.deltaTime;
            yVelocity = Mathf.Min(yVelocity, _rigidbody.velocity.y);
            if (playerController.playerMovementComponent.IsOnGround)
            {
                _playerController = playerController;
                _playerController.playerState = PlayerController.PlayerState.BreakFall;

                _controller.StartCoroutine(CoCameraRotate(_camera.transform.eulerAngles.x, 0));

                yield return new WaitForSeconds(_data.cameraSpinTime + 0.1f);

                if (yVelocity &lt; _data.yVelocityThreshold)
                {
                    _rigidbody.AddRelativeForce(Vector3.forward * _data.boostPower, ForceMode.VelocityChange);
                }
                break;
            }
            yield return null;
        }

        _isOnBreakFall = false;
        _playerController.playerState = PlayerController.PlayerState.Normal;
    }

    //구르기 마찰력 적용
    public void BreakFallFriction()
    {
        Vector3 frictionDirection = new Vector3(-_rigidbody.velocity.x, 0f, -_rigidbody.velocity.z).normalized * Time.fixedDeltaTime * _data.breakFallFriction;
        if (Mathf.Abs(_rigidbody.velocity.x) - Mathf.Abs(frictionDirection.x) &lt; 0) frictionDirection.x = -_rigidbody.velocity.x;
        if (Mathf.Abs(_rigidbody.velocity.z) - Mathf.Abs(frictionDirection.z) &lt; 0) frictionDirection.z = -_rigidbody.velocity.z;
        _rigidbody.AddForce(frictionDirection, ForceMode.VelocityChange);
    }

    private IEnumerator CoCameraRotate(float startXRotation, float endXRotation)
    {
        float current_time = 0f;
        float rotation = startXRotation;
        float end = (_camera.transform.eulerAngles.x % 360) + 360;

        Vector3 currentAngles = _camera.transform.eulerAngles;

        while (current_time &lt;= _data.cameraSpinTime)
        {
            current_time += Time.deltaTime;
            float xRotation = Mathf.Lerp(rotation % 360, end, current_time / _data.cameraSpinTime);
            _camera.transform.eulerAngles = new(xRotation, currentAngles.y, currentAngles.z);
            yield return null;
        }
        _camera.transform.eulerAngles = new(endXRotation, currentAngles.y, currentAngles.z);
        (Controller as PlayerController).playerMovementComponent.camXRotation = 0;
    }
}

                </code></pre></div>
                        <h6 class="mt-2">&#45; 코루틴을 이용해 땅에 닿은 직후 판정</h6>
                        <h6>&#45; 카메라 무브를 이용해 구르기 표현</h6>
                        <h6>&#45; 낙법 이후 속도 부스트 부여</h6>
                    </details>
                    <img class="img-fluid mb-3 mb-lg-0" src="assets/img/BeyondTheSpeed/Sliding.gif">
                    <details>
                        <summary>슬라이딩 구현 방법</summary>
                        <div class="bg-black text-left h-100 project source-codescroll"><pre class="source-codeplace" style="width: 1200px;"><code class="source-code">
using System.Collections;
using UnityEngine;
public class SlidingComponent : BaseComponent
{
    private Vector3 _originalColliderCenter;
    private float _originalColliderHeight;
    private readonly BaseController _controller;
    private SlidingData _data;

    private Rigidbody _rigidbody;
    private Camera _camera;
    private Vector3 _cameraOriginPos;
    private CapsuleCollider _capsuleCollider;

    private Coroutine _coroutine;
    private Coroutine _cameraMoveCoroutine;
    private bool _isTimeOver;
    private bool _isCoolTime;
    public SlidingComponent(BaseController controller, SlidingData data) : base(controller)
    {
        _controller = controller;
        _data = data;
        _camera = Camera.main;
        _rigidbody = _controller.GetComponent&lt;Rigidbody&gt;();
        _cameraOriginPos = _camera.transform.localPosition;
        _capsuleCollider = controller.GetComponent&lt;CapsuleCollider&gt;();
        _originalColliderCenter = _capsuleCollider.center;
        _originalColliderHeight = _capsuleCollider.height;
    }

    public void StartSliding(PlayerController playerController)
    {
        _capsuleCollider.center = _data.shrinkedColliderCenter;
        _capsuleCollider.height = _data.shrinkedColliderHeight;
        _isTimeOver = false;

        if (_cameraMoveCoroutine != null) _controller.StopCoroutine(_cameraMoveCoroutine);
        _cameraMoveCoroutine = _controller.StartCoroutine(CameraMove(_camera.transform.localPosition, _data.cameraHeight));

        playerController.playerState = PlayerController.PlayerState.Sliding;
        if(!_isCoolTime)
        {
            _isCoolTime = true;
            _controller.StartCoroutine(SlidingCoolTimeTimer());
            _rigidbody.AddForce(new Vector3(_rigidbody.velocity.x, 0f, _rigidbody.velocity.z).normalized * _data.slidingAcceleration);
        }
        if (_coroutine != null) _controller.StopCoroutine(_coroutine);
        _coroutine = _controller.StartCoroutine(SlidingTimer());
    }

    public void SlidingFriction(bool isOnGround)
    {
        bool isFlat = Vector3.Dot((Controller as PlayerController).playerMovementComponent.currentNormal, Vector3.up) &gt; 0.99f;
        bool isSlopingDown = isOnGround &amp;&amp; _rigidbody.velocity.y &lt; 0f &amp;&amp; !isFlat;

        float delta = _isTimeOver ? _data.slidingUpdateFriction : _data.slidingFriction;
        if (!isSlopingDown)
        {
            FrictionUpdate(delta);
        }
    }

    public void FrictionUpdate(float delta)
    {
        Vector3 frictionDirection = new Vector3(-_rigidbody.velocity.x, 0f, -_rigidbody.velocity.z).normalized * Time.fixedDeltaTime * delta;
        if (Mathf.Abs(_rigidbody.velocity.x) - Mathf.Abs(frictionDirection.x) &lt; 0) frictionDirection.x = -_rigidbody.velocity.x;
        if (Mathf.Abs(_rigidbody.velocity.z) - Mathf.Abs(frictionDirection.z) &lt; 0) frictionDirection.z = -_rigidbody.velocity.z;
        _rigidbody.AddForce(frictionDirection, ForceMode.VelocityChange);
    }

    public void EndSliding(PlayerController playerController)
    {
        _capsuleCollider.center = _originalColliderCenter;
        _capsuleCollider.height = _originalColliderHeight;
        _capsuleCollider.radius = 0.5f;
        playerController.playerState = PlayerController.PlayerState.Normal;

        if (_cameraMoveCoroutine != null) _controller.StopCoroutine(_cameraMoveCoroutine);
        _cameraMoveCoroutine = _controller.StartCoroutine(CameraMove(_camera.transform.localPosition, _cameraOriginPos));

        _controller.StopCoroutine(_coroutine);
    }
    IEnumerator SlidingTimer()
    {
        float timer = _data.slidingTime;
        while (timer &gt; 0)
        {
            yield return null;
            timer -= Time.deltaTime;
        }
        _isTimeOver = true;
    }
    IEnumerator SlidingCoolTimeTimer()
    {
        float timer = _data.slidingCoolTime;
        while (timer &gt; 0)
        {
            yield return null;
            timer -= Time.deltaTime;
        }
        _isCoolTime = false;
    }

    IEnumerator CameraMove(Vector3 startPos, Vector3 endPos)
    {
        float current_time = 0f;
        while (current_time &lt;= _data.cameraMoveTime)
        {
            current_time += Time.deltaTime;
            if (current_time &gt; _data.cameraMoveTime) current_time = _data.cameraMoveTime;
            _camera.transform.localPosition = Vector3.Lerp(startPos, endPos, current_time / _data.cameraMoveTime);
            yield return null;
        }
    }
}

                </code></pre></div>
                        <h6 class="mt-2">&#45; 슬라이딩 시작 시 코루틴으로 시간 체크(슬라이딩 가속 시간을 제한하기 위함)</h6>
                        <h6>&#45; 카메라 무브를 이용해 시점을 낮게 만들어 슬라이딩 표현</h6>
                        <h6>&#45; 콜라이더를 조절하여 슬라이딩 시 히트박스의 크기를 줄임</h6>
                    </details>
                    
                    <h5 class="mt-2">&#8226; 세이브 포인트</h5>
                    <img class="img-fluid mb-3 mb-lg-0" src="assets/img/BeyondTheSpeed/SavePoint.jpg">
                    <details>
                        <summary>세이브 포인트 구현 방법</summary>
                        <div class="bg-black text-left h-100 project source-codescroll"><pre class="source-codeplace" style="width: 1200px;"><code class="source-code">
using UnityEngine;

public class CheckPoint : MonoBehaviour
{
	private void OnTriggerEnter(Collider other)
	{
		if(other.CompareTag("Player"))
		{
			GameManager.Instance.SetRespawnPoint(transform.position);
			Destroy(gameObject);
			Debug.Log("세이브 되었습니다.");
		}
	}
}

                </code></pre></div>
                    <h6 class="mt-2">&#45; 트리거를 이용해 세이브 포인트로 기록</h6>
                    </details>
                    

                    
                    <h5 class="mt-2">&#8226; 게임 시스템</h5>
                    <img class="img-fluid mb-3 mb-lg-0" src="assets/img/BeyondTheSpeed/KeyItem.jpg">
                    <details>
                        <summary>점수 아이템 구현 방법</summary>
                        <div class="bg-black text-left h-100 project source-codescroll"><pre class="source-codeplace" style="width: 1200px;"><code class="source-code">
using UnityEngine;

public class KeyItem : MonoBehaviour
{
	private bool _isHandled;

	private void Start()
	{
		_isHandled = false;
	}

	private void OnTriggerEnter(Collider other)
	{
		if (_isHandled)
		{
			return;
		}

		if (other.gameObject.CompareTag("Player"))
		{
			GameManager.Instance.IncreaseKeyItem(this);
			_isHandled = true;
		}
	}
}

                </code></pre></div>
                        <h6 class="mt-2">&#45; 트리거를 이용해 판정</h6>
                        <h6>&#45; 중복으로 먹을 경우를 대비하여 Destroy 실행</h6>
                    </details>
                    <img class="img-fluid mb-3 mb-lg-0" src="assets/img/BeyondTheSpeed/ScoreBoard.jpg">
                    <details>
                        <summary>골인 지점 구현 방법</summary>
                        <div class="bg-black text-left h-100 project source-codescroll"><pre class="source-codeplace" style="width: 1200px;"><code class="source-code">
using TMPro;
using UnityEngine;

public class ScoreBoard : MonoBehaviour
{
    private GameObject _scoreBoard;

    private int _totalScore;

    private TMP_Text _time;
    private TMP_Text _keyItem;
    private TMP_Text _score;
    private TMP_Text _level;

    private void Start()
    {
        _scoreBoard = gameObject.FindChild&lt;Transform&gt;("ScoreBoard").gameObject;
        _time = _scoreBoard.gameObject.FindChild&lt;TMP_Text&gt;("Time");
        _keyItem = _scoreBoard.gameObject.FindChild&lt;TMP_Text&gt;("KeyItem");
        _score = _scoreBoard.gameObject.FindChild&lt;TMP_Text&gt;("Score");
        _level = _scoreBoard.gameObject.FindChild&lt;TMP_Text&gt;("Level");
    }
    public void Resulting(float time, int keyItem)
    {
        _totalScore = 0;
        _time.text = "Clear Time: " + (int)(time / 60f) + ":" + (int)(time % 60f);
        _keyItem.text = "Key Item : " + keyItem + "/10";
        int timeScore = 0;
        if ((int)time / 60f &lt;= 5) timeScore = 30000;
        else if ((int)time / 60f &lt;= 7) timeScore = 20000;
        else if ((int)time / 60f &lt;= 10) timeScore = 10000;
        _totalScore = (keyItem * 2000 + timeScore);
        _score.text = "Score : " + _totalScore;

        if(_totalScore &gt;= 40000)
            _level.text = "A";
        else if(_totalScore &gt;= 30000)
            _level.text = "B";
        else if (_totalScore &gt;= 20000)
            _level.text = "C";
        else if (_totalScore &gt;= 10000)
            _level.text = "D";
        else
            _level.text = "E";
    }
}

                </code></pre></div>
                        <h6 class="mt-2">&#45; 트리거를 이용해 판정</h6>
                        <h6>&#45; 타이머 코루틴 종료</h6>
                        <h6>&#45; 점수 계산 후 등급 표시</h6>
                        <h6>&#45; UGUI를 이용해 제작</h6>
                    </details>
                </div>
                <div class="row gx-0 mb-5 mb-lg-0 justify-content-center">
                    <div class="bg-black text-center h-100 project">
                        <h4 class="text-white" style="margin-top: 15px">코드 해석</h4>
                        <h6 class="text-white"><a href="https://github.com/DevJinsh/OnlyScriptsList/tree/main/BeyondTheSpeed">코드 보기(깃허브)</a></h6>
                        <h6 class="text-white"><a href="https://blog.naver.com/sanghun1425/223283103626">코드 해석(블로그)</a></h6>
                    </div>
                </div>
                <div class="row gx-0 mt-5 mb-1 mb-lg-4 align-items-center">
                    <div class="bg-black text-center h-100">
                        <h4 class="text-white" style="margin-top: 15px">배운 점 &amp; 느낀 점</h4>
                    </div>
                </div>
                <ul>
                    <li>원래 생각했던 조작이란 그저 조작키를 누른대로 행동하는가 였습니다. 하지만 프로젝트를 진행하면서 내가 원하는 대로 제어할 수 있는 것이 조작이라는 것을 배웠습니다. 때문에 플레이어가 본인의 캐릭터를 얼마나 정확히 제어할 수 있는가가 조작감의 핵심이라고 생각하게 되었습니다.</li>
                    <li>카메라 시점을 이용해 현재 동작에 대한 피드백을 주는 것이 생각보다 좋은 방법이지만 시점의 어지러움으로 인해 진입장벽이 생길 수 있겠다는 생각이 들었습니다.</li>
                    <li>코드의 규칙을 정하고 개발을 하니 코드의 일관성이 개선되어 다른 팀원이 짠 코드더라도 수정을 할 수 있는 정도의 이해도를 쉽게 가질 수 있었습니다.</li>
                </ul>
            </div>
        </section>
        
        <!-- Footer-->
        <footer class="footer bg-black small text-center text-white-50"><div class="container px-4 px-lg-5">Copyright &copy; Jinsanghun Portfolio Site 2024</div></footer>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>
        <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
        <!-- * *                               SB Forms JS                               * *-->
        <!-- * * Activate your form at https://startbootstrap.com/solution/contact-forms * *-->
        <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
        <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>
    </body>
</html>
